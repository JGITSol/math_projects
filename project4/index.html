<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Forces & Equilibrium Analyzer | Mechanics</title>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide@0.469.0/dist/umd/lucide.min.js"></script>
    <link rel="stylesheet" href="../assets/site.css">
</head>

<body class="project-page">
    <div class="container">
        <header>
            <div class="header-content">
                <a href="../index.html" class="back-link">
                    <i data-lucide="arrow-left"></i> Back to Hub
                </a>
                <h1 data-i18n="title">2D Forces & Equilibrium Analyzer</h1>
                <p class="subtitle" data-i18n="subtitle">Analyze concurrent forces, calculate resultants, and verify equilibrium conditions</p>
            </div>
        </header>

        <div class="grid">
            <!-- Control Panel -->
            <div class="card">
                <div class="card-header"><i data-lucide="settings-2" style="margin-right: 8px;"></i> <span data-i18n="config">Configuration</span></div>

                <div class="form-group">
                    <label><span data-i18n="magLabel">Magnitude (N)</span>: <span id="valMag">100</span></label>
                    <input type="number" id="inputMag" value="100" min="1" max="500" step="10">
                </div>

                <div class="form-group">
                    <label><span data-i18n="angleLabel">Angle (degrees)</span>: <span id="valAngle">0</span></label>
                    <input type="number" id="inputAngle" value="0" min="0" max="360" step="5">
                </div>

                <div class="form-group">
                    <label><span data-i18n="pointXLabel">Point X (m)</span>: <span id="valX">0</span></label>
                    <input type="number" id="inputX" value="0" min="-10" max="10" step="0.5">
                </div>

                <div class="form-group">
                    <label><span data-i18n="pointYLabel">Point Y (m)</span>: <span id="valY">0</span></label>
                    <input type="number" id="inputY" value="0" min="-10" max="10" step="0.5">
                </div>

                <button id="btnAddForce" data-i18n="addForce">Add Force</button>
                <button id="btnClear" style="background-color: var(--warning);" data-i18n="clearAll">Clear All</button>

                <div class="badge" data-i18n="badgeForces">Forces</div>
                <div class="badge" data-i18n="badgeEquilibrium">Equilibrium</div>
                <div class="badge" data-i18n="badgeMoments">Moments</div>

                <!-- Forces List -->
                <div style="margin-top: 16px;">
                    <h3 style="font-size: 0.9rem; margin: 0 0 8px 0; color: var(--primary-dark);">Active Forces</h3>
                    <div id="forcesList" class="forces-list"></div>
                </div>

                <!-- Equilibrium Status -->
                <div id="equilibriumStatus" class="equilibrium-status hidden">
                    ‚úì System in Equilibrium
                </div>
            </div>

            <!-- Visualization & Analysis -->
            <div>
                <!-- Visualization Panel -->
                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h2 data-i18n="vizTitle">Force Diagram</h2>
                        <div style="font-size: 0.9rem; color: var(--text-light);">
                            <span style="color:var(--primary)">‚óè Force</span>
                            <span style="color:var(--error)">‚óè Resultant</span>
                            <span style="color:var(--success)">‚óè Equilibrant</span>
                        </div>
                    </div>
                    <!-- Canvas -->
                    <div class="card">
                        <div class="card-header">Force Diagram (Free-Body Diagram)</div>
                        <div class="canvas-container" style="height: 450px;">
                            <canvas id="forceCanvas"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Resultant & Analysis -->
                <div class="card">
                    <div class="card-header">Force Analysis</div>

                    <div class="info-section">
                        <h3>Resultant Force</h3>
                        <div class="results-grid">
                            <div class="result-item">
                                <strong>Fx (N)</strong>
                                <span id="resFx">0.00</span>
                            </div>
                            <div class="result-item">
                                <strong>Fy (N)</strong>
                                <span id="resFy">0.00</span>
                            </div>
                            <div class="result-item">
                                <strong>Magnitude</strong>
                                <span id="resMag">0.00 N</span>
                            </div>
                            <div class="result-item">
                                <strong>Direction</strong>
                                <span id="resDir">0.00¬∞</span>
                            </div>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3>Moment Analysis (about origin)</h3>
                        <div class="results-grid">
                            <div class="result-item">
                                <strong>Total Moment (N¬∑m)</strong>
                                <span id="resMoment">0.00</span>
                            </div>
                            <div class="result-item">
                                <strong>Equilibrium Check</strong>
                                <span id="equilCheck">Œ£F ‚â† 0, Œ£M ‚â† 0</span>
                            </div>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3>Equilibrium Conditions</h3>
                        <p><strong>Œ£Fx = 0:</strong> <span id="checkFx">‚úó Not balanced</span></p>
                        <p><strong>Œ£Fy = 0:</strong> <span id="checkFy">‚úó Not balanced</span></p>
                        <p><strong>Œ£M = 0:</strong> <span id="checkMoment">‚úó Not balanced</span></p>
                    </div>
                </div>

                <!-- Real World Applications -->
                <div class="card">
                    <div class="card-header">Real World Applications</div>
                    <div class="tab-header">
                        <button class="tab-btn active" data-tab="truss">Truss</button>
                        <button class="tab-btn" data-tab="beam">Beam</button>
                        <button class="tab-btn" data-tab="pulley">Pulley</button>
                        <button class="tab-btn" data-tab="landing">Landing Gear</button>
                    </div>
                    <div id="engineeringApp">
                        <!-- Content rendered by JS -->
                    </div>
                </div>

                <!-- Free-Body Diagram Explanation -->
                <div class="card">
                    <div class="card-header">How to Use</div>
                    <div class="info-section">
                        <h3>Steps</h3>
                        <p>1. Enter force magnitude (N) and angle (¬∞ from horizontal)</p>
                        <p>2. Enter application point (x, y coordinates in meters)</p>
                        <p>3. Click "Add Force" or click canvas to place force visually</p>
                        <p>4. Repeat to add multiple forces</p>
                        <p>5. Analyze resultant, moments, and equilibrium status</p>
                    </div>

                    <div class="info-section">
                        <h3>Equilibrium Requirements</h3>
                        <p>For static equilibrium: Œ£Fx = 0, Œ£Fy = 0, Œ£M = 0</p>
                        <p>All three conditions must be satisfied simultaneously</p>
                    </div>
                </div>

                <!-- Engineering Applications -->
                <div class="card">
                    <div class="card-header">Real-World Applications</div>
                    <div id="engineeringApp" class="engineering-box"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            en: {
                title: "2D Forces & Equilibrium Analyzer",
                subtitle: "Analyze concurrent forces, calculate resultants, and verify equilibrium conditions",
                config: "Configuration",
                addForce: "Add Force",
                magLabel: "Magnitude (N)",
                angleLabel: "Angle (degrees)",
                pointXLabel: "Point X (m)",
                pointYLabel: "Point Y (m)",
                badgeForces: "Forces",
                badgeEquilibrium: "Equilibrium",
                badgeMoments: "Moments",
                forcesList: "Forces List",
                vizTitle: "Force Diagram",
                resultsTitle: "Analysis Results",
                resultantForce: "Resultant Force (R)",
                equilibrantForce: "Equilibrant Force (E)",
                equilibriumStatus: "Equilibrium Status",
                eqCheckTitle: "Equilibrium Check (Œ£Fx = 0, Œ£Fy = 0)",
                engContext: "Engineering Context",

                // Status
                balanced: "BALANCED (Equilibrium)",
                unbalanced: "UNBALANCED",

                // Contexts
                particle: "Particle Equilibrium",
                truss: "Truss Joint Analysis",
                bracket: "Bracket Support",
                pulleys: "Pulley System",

                // UI
                showRes: "Show Resultant",
                showEquil: "Show Equilibrant",
                showComp: "Show Components",
                clearAll: "Clear All",
                remove: "Remove"
            },
            pl: {
                title: "Si≈Çy 2D i Stan R√≥wnowagi",
                subtitle: "Analiza si≈Ç zbie≈ºnych, obliczanie wypadkowej i weryfikacja r√≥wnowagi",
                config: "Konfiguracja",
                addForce: "Dodaj Si≈Çƒô",
                magLabel: "Warto≈õƒá (N)",
                angleLabel: "KƒÖt (stopnie)",
                pointXLabel: "Punkt X (m)",
                pointYLabel: "Punkt Y (m)",
                badgeForces: "Si≈Çy",
                badgeEquilibrium: "R√≥wnowaga",
                badgeMoments: "Momenty",
                forcesList: "Lista Si≈Ç",
                vizTitle: "Diagram Si≈Ç",
                resultsTitle: "Wyniki Analizy",
                resultantForce: "Si≈Ça Wypadkowa (R)",
                equilibrantForce: "Si≈Ça R√≥wnowa≈ºƒÖca (E)",
                equilibriumStatus: "Stan R√≥wnowagi",
                eqCheckTitle: "Warunek R√≥wnowagi",
                engContext: "Kontekst In≈ºynierski",
                balanced: "W R√ìWNOWADZE",
                unbalanced: "BRAK R√ìWNOWAGI",
                particle: "R√≥wnowaga Punktu",
                truss: "Wƒôze≈Ç Kratownicy",
                bracket: "Wspornik",
                pulleys: "Uk≈Çad Bloczk√≥w",
                showRes: "Poka≈º WypadkowƒÖ",
                showEquil: "Poka≈º R√≥wnowa≈ºƒÖcƒÖ",
                showComp: "Poka≈º Sk≈Çadowe",
                clearAll: "Wyczy≈õƒá Wszystko",
                remove: "Usu≈Ñ"
            },
            fr: {
                title: "Forces 2D & √âquilibre",
                subtitle: "Analysez les forces concourantes, calculez les r√©sultantes et v√©rifiez l'√©quilibre",
                config: "Configuration",
                addForce: "Ajouter Force",
                magLabel: "Magnitude (N)",
                angleLabel: "Angle (degr√©s)",
                forcesList: "Liste des Forces",
                vizTitle: "Diagramme des Forces",
                resultsTitle: "R√©sultats",
                resultantForce: "Force R√©sultante (R)",
                equilibrantForce: "Force √âquilibrante (E)",
                equilibriumStatus: "√âtat d'√âquilibre",
                eqCheckTitle: "V√©rification d'√âquilibre",
                engContext: "Contexte Ing√©nierie",
                balanced: "√âQUILIBR√â",
                unbalanced: "NON √âQUILIBR√â",
                particle: "√âquilibre du Point",
                truss: "Analyse de Treillis",
                bracket: "Support",
                pulleys: "Syst√®me de Poulies",
                showRes: "Afficher R√©sultante",
                showEquil: "Afficher √âquilibrante",
                showComp: "Afficher Composantes",
                clearAll: "Tout Effacer",
                remove: "Supprimer"
            },
            es: {
                title: "Fuerzas 2D y Equilibrio",
                subtitle: "Analiza fuerzas concurrentes, calcula resultantes y verifica el equilibrio",
                config: "Configuraci√≥n",
                addForce: "A√±adir Fuerza",
                magLabel: "Magnitud (N)",
                angleLabel: "√Ångulo (grados)",
                forcesList: "Lista de Fuerzas",
                vizTitle: "Diagrama de Fuerzas",
                resultsTitle: "Resultados",
                resultantForce: "Fuerza Resultante (R)",
                equilibrantForce: "Fuerza Equilibrante (E)",
                equilibriumStatus: "Estado de Equilibrio",
                eqCheckTitle: "Verificaci√≥n de Equilibrio",
                engContext: "Contexto de Ingenier√≠a",
                balanced: "EQUILIBRADO",
                unbalanced: "DESEQUILIBRADO",
                particle: "Equilibrio de Part√≠cula",
                truss: "An√°lisis de Armadura",
                bracket: "Soporte",
                pulleys: "Sistema de Poleas",
                showRes: "Mostrar Resultante",
                showEquil: "Mostrar Equilibrante",
                showComp: "Mostrar Componentes",
                clearAll: "Borrar Todo",
                remove: "Eliminar"
            },
            pt: {
                title: "For√ßas 2D e Equil√≠brio",
                subtitle: "Analise for√ßas concorrentes, calcule resultantes e verifique o equil√≠brio",
                config: "Configura√ß√£o",
                addForce: "Adicionar For√ßa",
                magLabel: "Magnitude (N)",
                angleLabel: "√Çngulo (graus)",
                forcesList: "Lista de For√ßas",
                vizTitle: "Diagrama de For√ßas",
                resultsTitle: "Resultados",
                resultantForce: "For√ßa Resultante (R)",
                equilibrantForce: "For√ßa Equilibrante (E)",
                equilibriumStatus: "Estado de Equil√≠brio",
                eqCheckTitle: "Verifica√ß√£o de Equil√≠brio",
                engContext: "Contexto de Engenharia",
                balanced: "EQUILIBRADO",
                unbalanced: "DESEQUILIBRADO",
                particle: "Equil√≠brio de Part√≠cula",
                truss: "An√°lise de Treli√ßa",
                bracket: "Suporte",
                pulleys: "Sistema de Polias",
                showRes: "Mostrar Resultante",
                showEquil: "Mostrar Equilibrante",
                showComp: "Mostrar Componentes",
                clearAll: "Limpar Tudo",
                remove: "Remover"
            },
            de: {
                title: "2D Kr√§fte & Gleichgewicht",
                subtitle: "Analysieren Sie Kr√§fte, berechnen Sie Resultierende und pr√ºfen Sie das Gleichgewicht",
                config: "Konfiguration",
                addForce: "Kraft Hinzuf√ºgen",
                magLabel: "Betrag (N)",
                angleLabel: "Winkel (Grad)",
                forcesList: "Liste der Kr√§fte",
                vizTitle: "Kraftdiagramm",
                resultsTitle: "Ergebnisse",
                resultantForce: "Resultierende Kraft (R)",
                equilibrantForce: "Gleichgewichtskraft (E)",
                equilibriumStatus: "Gleichgewichtsstatus",
                eqCheckTitle: "Gleichgewichtspr√ºfung",
                engContext: "Technischer Kontext",
                balanced: "IM GLEICHGEWICHT",
                unbalanced: "UNAUSGEGLICHEN",
                particle: "Punktgleichgewicht",
                truss: "Fachwerkanalyse",
                bracket: "Halterung",
                pulleys: "Flaschenzug",
                showRes: "Resultierende Anzeigen",
                showEquil: "Gleichgewichtskraft Anzeigen",
                showComp: "Komponenten Anzeigen",
                clearAll: "Alles L√∂schen",
                remove: "Entfernen"
            },
            ua: {
                title: "2D –°–∏–ª–∏ —Ç–∞ –†—ñ–≤–Ω–æ–≤–∞–≥–∞",
                subtitle: "–ê–Ω–∞–ª—ñ–∑ –∑–±—ñ–∂–Ω–∏—Ö —Å–∏–ª, —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä—ñ–≤–Ω–æ–¥—ñ–π–Ω–æ—ó —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä—ñ–≤–Ω–æ–≤–∞–≥–∏",
                config: "–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è",
                addForce: "–î–æ–¥–∞—Ç–∏ –°–∏–ª—É",
                magLabel: "–í–µ–ª–∏—á–∏–Ω–∞ (–ù)",
                angleLabel: "–ö—É—Ç (–≥—Ä–∞–¥—É—Å–∏)",
                forcesList: "–°–ø–∏—Å–æ–∫ –°–∏–ª",
                vizTitle: "–î—ñ–∞–≥—Ä–∞–º–∞ –°–∏–ª",
                resultsTitle: "–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ê–Ω–∞–ª—ñ–∑—É",
                resultantForce: "–†—ñ–≤–Ω–æ–¥—ñ–π–Ω–∞ –°–∏–ª–∞ (R)",
                equilibrantForce: "–ó—Ä—ñ–≤–Ω–æ–≤–∞–∂—É—é—á–∞ –°–∏–ª–∞ (E)",
                equilibriumStatus: "–°—Ç–∞–Ω –†—ñ–≤–Ω–æ–≤–∞–≥–∏",
                eqCheckTitle: "–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –†—ñ–≤–Ω–æ–≤–∞–≥–∏",
                engContext: "–Ü–Ω–∂–µ–Ω–µ—Ä–Ω–∏–π –ö–æ–Ω—Ç–µ–∫—Å—Ç",
                balanced: "–í –†–Ü–í–ù–û–í–ê–ó–Ü",
                unbalanced: "–ù–ï –í –†–Ü–í–ù–û–í–ê–ó–Ü",
                particle: "–†—ñ–≤–Ω–æ–≤–∞–≥–∞ –¢–æ—á–∫–∏",
                truss: "–í—É–∑–æ–ª –§–µ—Ä–º–∏",
                bracket: "–ö—Ä–æ–Ω—à—Ç–µ–π–Ω",
                pulleys: "–°–∏—Å—Ç–µ–º–∞ –ë–ª–æ–∫—ñ–≤",
                showRes: "–ü–æ–∫–∞–∑–∞—Ç–∏ –†—ñ–≤–Ω–æ–¥—ñ–π–Ω—É",
                showEquil: "–ü–æ–∫–∞–∑–∞—Ç–∏ –ó—Ä—ñ–≤–Ω–æ–≤–∞–∂—É—é—á—É",
                showComp: "–ü–æ–∫–∞–∑–∞—Ç–∏ –°–∫–ª–∞–¥–æ–≤—ñ",
                clearAll: "–û—á–∏—Å—Ç–∏—Ç–∏ –í—Å–µ",
                remove: "–í–∏–¥–∞–ª–∏—Ç–∏"
            },
            be: {
                title: "2D –°—ñ–ª—ã —ñ –†–∞—û–Ω–∞–≤–∞–≥–∞",
                subtitle: "–ê–Ω–∞–ª—ñ–∑ –∑–±–µ–∂–Ω—ã—Ö —Å—ñ–ª, —Ä–∞–∑–ª—ñ–∫ —Ä–∞—û–Ω–æ–¥–∑–µ–π–Ω–∞–π —ñ –ø—Ä–∞–≤–µ—Ä–∫–∞ —Ä–∞—û–Ω–∞–≤–∞–≥—ñ",
                config: "–ö–∞–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ã—è",
                addForce: "–î–∞–¥–∞—Ü—å –°—ñ–ª—É",
                magLabel: "–í–µ–ª—ñ—á—ã–Ω—è (–ù)",
                angleLabel: "–í—É–≥–∞–ª (–≥—Ä–∞–¥—É—Å—ã)",
                forcesList: "–°–ø—ñ—Å –°—ñ–ª",
                vizTitle: "–î—ã—è–≥—Ä–∞–º–∞ –°—ñ–ª",
                resultsTitle: "–í—ã–Ω—ñ–∫—ñ –ê–Ω–∞–ª—ñ–∑—É",
                resultantForce: "–†–∞—û–Ω–æ–¥–∑–µ–π–Ω–∞—è –°—ñ–ª–∞ (R)",
                equilibrantForce: "–£—Ä–∞—û–Ω–∞–≤–∞–∂–≤–∞–ª—å–Ω–∞—è –°—ñ–ª–∞ (E)",
                equilibriumStatus: "–°—Ç–∞–Ω –†–∞—û–Ω–∞–≤–∞–≥—ñ",
                eqCheckTitle: "–ü—Ä–∞–≤–µ—Ä–∫–∞ –†–∞—û–Ω–∞–≤–∞–≥—ñ",
                engContext: "–Ü–Ω–∂—ã–Ω–µ—Ä–Ω—ã –ö–∞–Ω—Ç—ç–∫—Å—Ç",
                balanced: "–£ –†–ê–é–ù–ê–í–ê–ó–ï",
                unbalanced: "–ù–ï –£ –†–ê–é–ù–ê–í–ê–ó–ï",
                particle: "–†–∞—û–Ω–∞–≤–∞–≥–∞ –ö—Ä–æ–ø–∫—ñ",
                truss: "–í—É–∑–µ–ª –§–µ—Ä–º—ã",
                bracket: "–ö—Ä–∞–Ω—à—Ç—ç–π–Ω",
                pulleys: "–°—ñ—Å—Ç—ç–º–∞ –ë–ª–æ–∫–∞—û",
                showRes: "–ü–∞–∫–∞–∑–∞—Ü—å –†–∞—û–Ω–æ–¥–∑–µ–π–Ω—É—é",
                showEquil: "–ü–∞–∫–∞–∑–∞—Ü—å –£—Ä–∞—û–Ω–∞–≤–∞–∂–≤–∞–ª—å–Ω—É—é",
                showComp: "–ü–∞–∫–∞–∑–∞—Ü—å –°–∫–ª–∞–¥–Ω—ñ–∫—ñ",
                clearAll: "–ê—á—ã—Å—Ü—ñ—Ü—å –£—Å—ë",
                remove: "–í—ã–¥–∞–ª—ñ—Ü—å"
            }
        };

        const app = {
            canvas: null,
            ctx: null,
            forces: [],
            state: {
                magnitude: 100,
                angle: 0,
                x: 0,
                y: 0,
                context: 'truss',
                lang: 'en',
                theme: 'light'
            },

            getVar: (name) => getComputedStyle(document.documentElement).getPropertyValue(name).trim(),

            // setTheme and setLang removed - handled by site.js

            init: () => {
                app.canvas = document.getElementById('forceCanvas');
                app.ctx = app.canvas.getContext('2d');

                // Set canvas size
                const container = app.canvas.parentElement;
                app.canvas.width = container.clientWidth;
                app.canvas.height = container.clientHeight;

                // Event listeners for inputs
                document.getElementById('inputMag').addEventListener('input', (e) => {
                    app.state.magnitude = parseFloat(e.target.value);
                    document.getElementById('valMag').textContent = app.state.magnitude.toFixed(0);
                });

                document.getElementById('inputAngle').addEventListener('input', (e) => {
                    app.state.angle = parseFloat(e.target.value);
                    document.getElementById('valAngle').textContent = app.state.angle.toFixed(0);
                });

                document.getElementById('inputX').addEventListener('input', (e) => {
                    app.state.x = parseFloat(e.target.value);
                    document.getElementById('valX').textContent = app.state.x.toFixed(1);
                });

                document.getElementById('inputY').addEventListener('input', (e) => {
                    app.state.y = parseFloat(e.target.value);
                    document.getElementById('valY').textContent = app.state.y.toFixed(1);
                });

                document.getElementById('btnAddForce').addEventListener('click', app.addForce);
                document.getElementById('btnClear').addEventListener('click', app.clearAllForces);

                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        app.state.context = e.target.getAttribute('data-tab');
                        app.displayEngineering();
                    });
                });

                app.canvas.addEventListener('click', (e) => {
                    const rect = app.canvas.getBoundingClientRect();
                    const px = (e.clientX - rect.left) / app.scale - app.offsetX;
                    const py = -(e.clientY - rect.top) / app.scale + app.offsetY;

                    app.state.x = px;
                    app.state.y = py;
                    document.getElementById('inputX').value = px.toFixed(1);
                    document.getElementById('inputY').value = py.toFixed(1);
                    document.getElementById('valX').textContent = px.toFixed(1);
                    document.getElementById('valY').textContent = py.toFixed(1);
                });

                // Listen for site.js events
                window.addEventListener('themechange', (e) => {
                    app.state.theme = e.detail.theme;
                    app.draw();
                });
                
                window.addEventListener('langchange', (e) => {
                    app.state.lang = e.detail.lang;
                    // Need to manually update translations here since setLang is gone
                    const dict = translations[app.state.lang] || translations.en;
                    document.querySelectorAll('[data-i18n]').forEach(el => {
                        const key = el.getAttribute('data-i18n');
                        if (!key) return;
                        const v = dict[key];
                        if (v !== undefined && v !== null) el.textContent = String(v);
                    });
                    app.updateForcesList();
                });

                // Initial sync
                app.state.theme = document.documentElement.getAttribute('data-theme') || 'light';
                app.state.lang = document.documentElement.getAttribute('lang') || 'en';
                
                // Initial translation apply
                const dict = translations[app.state.lang] || translations.en;
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (!key) return;
                    const v = dict[key];
                    if (v !== undefined && v !== null) el.textContent = String(v);
                });

                app.displayEngineering();
                app.updateForcesList();
                app.draw();
                lucide.createIcons();
            },

            scale: 30,
            offsetX: 0,
            offsetY: 0,

            addForce: () => {
                const force = {
                    magnitude: app.state.magnitude,
                    angle: app.state.angle * Math.PI / 180,
                    x: app.state.x,
                    y: app.state.y,
                    fx: app.state.magnitude * Math.cos(app.state.angle * Math.PI / 180),
                    fy: app.state.magnitude * Math.sin(app.state.angle * Math.PI / 180)
                };
                app.forces.push(force);
                app.update();
            },

            clearAllForces: () => { // Renamed from clearAll
                app.forces = [];
                app.update();
            },

            removeForce: (index) => {
                app.forces.splice(index, 1);
                app.update();
            },

            update: () => {
                app.updateForcesList();
                app.calculateResultant();
                app.calculateMoments();
                app.draw();
            },

            updateForcesList: () => {
                const list = document.getElementById('forcesList');
                if (app.forces.length === 0) {
                    list.innerHTML = '<div style="padding: 8px; text-align: center; color: var(--text-light); font-size: 0.75rem;">No forces added</div>';
                    return;
                }

                list.innerHTML = app.forces.map((f, i) => `
                    <div class="force-item">
                        <span>F${i + 1}: ${f.magnitude.toFixed(0)}N @ ${(f.angle * 180 / Math.PI).toFixed(0)}¬∞ at (${f.x.toFixed(1)}, ${f.y.toFixed(1)})</span>
                        <button onclick="app.removeForce(${i})">‚úï</button>
                    </div>
                `).join('');
            },

            calculateResultant: () => {
                let sumFx = 0, sumFy = 0;
                app.forces.forEach(f => {
                    sumFx += f.fx;
                    sumFy += f.fy;
                });

                const magnitude = Math.sqrt(sumFx * sumFx + sumFy * sumFy);
                const direction = Math.atan2(sumFy, sumFx) * 180 / Math.PI;

                document.getElementById('resFx').textContent = sumFx.toFixed(2);
                document.getElementById('resFy').textContent = sumFy.toFixed(2);
                document.getElementById('resMag').textContent = magnitude.toFixed(2) + ' N';
                document.getElementById('resDir').textContent = direction.toFixed(2) + '¬∞';

                const fxBalanced = Math.abs(sumFx) < 0.1;
                const fyBalanced = Math.abs(sumFy) < 0.1;

                document.getElementById('checkFx').innerHTML = fxBalanced ? '‚úì Balanced' : '‚úó Not balanced';
                document.getElementById('checkFx').style.color = fxBalanced ? 'var(--success)' : 'var(--error)';

                document.getElementById('checkFy').innerHTML = fyBalanced ? '‚úì Balanced' : '‚úó Not balanced';
                document.getElementById('checkFy').style.color = fyBalanced ? 'var(--success)' : 'var(--error)';

                return { sumFx, sumFy, fxBalanced, fyBalanced };
            },

            calculateMoments: () => {
                let sumM = 0;
                app.forces.forEach(f => {
                    const moment = f.x * f.fy - f.y * f.fx;
                    sumM += moment;
                });

                document.getElementById('resMoment').textContent = sumM.toFixed(2);

                const mBalanced = Math.abs(sumM) < 0.1;
                document.getElementById('checkMoment').innerHTML = mBalanced ? '‚úì Balanced' : '‚úó Not balanced';
                document.getElementById('checkMoment').style.color = mBalanced ? 'var(--success)' : 'var(--error)';

                const result = app.calculateResultant();
                const allBalanced = result.fxBalanced && result.fyBalanced && mBalanced;

                const status = document.getElementById('equilibriumStatus');
                if (allBalanced && app.forces.length > 0) {
                    status.textContent = '‚úì System in Equilibrium';
                    status.classList.remove('unbalanced');
                    status.classList.add('balanced');
                    status.classList.remove('hidden');
                } else if (app.forces.length > 0) {
                    status.textContent = '‚úó System Not in Equilibrium';
                    status.classList.remove('balanced');
                    status.classList.add('unbalanced');
                    status.classList.remove('hidden');
                } else {
                    status.classList.add('hidden');
                }

                return sumM;
            },

            draw: () => {
                const w = app.canvas.width;
                const h = app.canvas.height;
                const ctx = app.ctx;

                // Use CSS variables for colors
                const bgColor = app.getVar('--grid-bg');
                const gridColor = app.getVar('--grid-line');
                const textColor = app.getVar('--text-main');
                const primaryColor = app.getVar('--primary');
                const errorColor = app.getVar('--error');
                const successColor = app.getVar('--success');
                const warningColor = app.getVar('--warning');
                const accentColor = app.getVar('--accent');

                // Clear
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, w, h);

                const cx = w / 2;
                const cy = h / 2;

                // Local to Screen transform
                const toScreenX = (x) => cx + (x - app.offsetX) * app.scale;
                const toScreenY = (y) => cy - (y - app.offsetY) * app.scale;

                // Draw Grid
                ctx.lineWidth = 1;
                ctx.strokeStyle = gridColor;

                // Calculate grid spacing
                let step = 1;
                if (app.scale > 80) step = 0.5;
                if (app.scale > 150) step = 0.1;
                if (app.scale < 30) step = 2;
                if (app.scale < 15) step = 5;

                const xMin = app.offsetX - cx / app.scale;
                const xMax = app.offsetX + cx / app.scale;
                const yMin = app.offsetY - cy / app.scale;
                const yMax = app.offsetY + cy / app.scale;

                const startX = Math.floor(xMin / step) * step;
                const startY = Math.floor(yMin / step) * step;

                ctx.beginPath();
                for (let x = startX; x <= xMax; x += step) {
                    ctx.moveTo(toScreenX(x), 0);
                    ctx.lineTo(toScreenX(x), h);
                }
                for (let y = startY; y <= yMax; y += step) {
                    ctx.moveTo(0, toScreenY(y));
                    ctx.lineTo(w, toScreenY(y));
                }
                ctx.stroke();

                // Axes
                ctx.lineWidth = 2;
                ctx.strokeStyle = textColor;
                ctx.beginPath();
                ctx.moveTo(0, toScreenY(0));
                ctx.lineTo(w, toScreenY(0));
                ctx.moveTo(toScreenX(0), 0);
                ctx.lineTo(toScreenX(0), h);
                ctx.stroke();

                // Draw Forces
                app.forces.forEach((f, idx) => {
                    const fx = toScreenX(f.x);
                    const fy = toScreenY(f.y);

                    // Force application point
                    ctx.fillStyle = primaryColor;
                    ctx.beginPath();
                    ctx.arc(fx, fy, 4, 0, 2 * Math.PI);
                    ctx.fill();

                    // Force vector
                    // f.angle is in Radians (stored by addForce)
                    const arrowLen = Math.min(100, f.magnitude * 0.5);
                    const dx = Math.cos(f.angle) * arrowLen;
                    const dy = -Math.sin(f.angle) * arrowLen; // Canvas Y is inverted relative to math Y

                    const colors = [primaryColor, accentColor, successColor, warningColor];
                    ctx.strokeStyle = colors[idx % colors.length];
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(fx, fy);
                    ctx.lineTo(fx + dx, fy + dy);
                    ctx.stroke();

                    // Arrowhead
                    const headlen = 10;
                    const angle = Math.atan2(dy, dx);
                    ctx.fillStyle = colors[idx % colors.length];
                    ctx.beginPath();
                    ctx.moveTo(fx + dx, fy + dy);
                    ctx.lineTo(fx + dx - headlen * Math.cos(angle - Math.PI / 6), fy + dy - headlen * Math.sin(angle - Math.PI / 6));
                    ctx.lineTo(fx + dx - headlen * Math.cos(angle + Math.PI / 6), fy + dy - headlen * Math.sin(angle + Math.PI / 6));
                    ctx.fill();

                    // Label
                    ctx.fillStyle = textColor;
                    ctx.font = 'bold 12px Inter';
                    ctx.fillText(`F${idx + 1}`, fx + dx + 10, fy + dy);
                });

                // Draw Resultant
                if (app.forces.length > 0) {
                    let sumFx = 0, sumFy = 0;
                    app.forces.forEach(f => {
                        sumFx += f.fx;
                        sumFy += f.fy;
                    });

                    const resMag = Math.sqrt(sumFx * sumFx + sumFy * sumFy);
                    if (resMag > 0.1) {
                        const arrowLen = Math.min(120, resMag * 0.5);
                        const rx = (sumFx / resMag) * arrowLen;
                        const ry = -(sumFy / resMag) * arrowLen;

                        app.ctx.strokeStyle = errorColor;
                        app.ctx.lineWidth = 3;
                        app.ctx.setLineDash([5, 5]);
                        app.ctx.beginPath();
                        app.ctx.moveTo(cx, cy);
                        app.ctx.lineTo(cx + rx, cy + ry);
                        app.ctx.stroke();
                        app.ctx.setLineDash([]);

                        // Arrowhead
                        const angle = Math.atan2(ry, rx);
                        const headlen = 10;
                        app.ctx.beginPath();
                        app.ctx.moveTo(cx + rx, cy + ry);
                        app.ctx.lineTo(cx + rx - headlen * Math.cos(angle - Math.PI / 6), cy + ry - headlen * Math.sin(angle - Math.PI / 6));
                        app.ctx.moveTo(cx + rx, cy + ry);
                        app.ctx.lineTo(cx + rx - headlen * Math.cos(angle + Math.PI / 6), cy + ry - headlen * Math.sin(angle + Math.PI / 6));
                        app.ctx.stroke();

                        app.ctx.fillStyle = errorColor;
                        app.ctx.font = 'bold 12px Inter';
                        app.ctx.fillText(`Œ£F=${resMag.toFixed(1)}N`, cx + rx + 15, cy + ry);
                    }
                }
            },

            displayEngineering: () => {
                const ctx = app.state.context;
                let html = '';

                const contexts = {
                    truss: {
                        title: 'üèóÔ∏è Truss Joint Analysis',
                        desc: 'Forces at pin joints must be in equilibrium. Find member forces (tension/compression) by solving Œ£Fx=0, Œ£Fy=0. Method of joints uses force equilibrium at each node.',
                        example: 'At a truss joint, all forces must sum to zero for static equilibrium.'
                    },
                    beam: {
                        title: 'üè¢ Beam Support Reactions',
                        desc: 'Distributed loads and concentrated forces on beams create reactions at supports. Sum forces vertically/horizontally and sum moments about support points to find reaction forces and moments.',
                        example: 'Sum moments about one support to find the other reaction, then use Œ£Fy=0.'
                    },
                    pulley: {
                        title: 'üîó Pulley & Cable Systems',
                        desc: 'Ideal (frictionless) pulleys change force direction. Tensions in cables connected through pulleys are equal if massless. Equilibrium of the load applies: sum of cable tensions = load weight.',
                        example: 'For a single movable pulley: 2T = Weight (force is halved, distance doubled).'
                    },
                    landing: {
                        title: '‚úàÔ∏è Landing Gear Impact Forces',
                        desc: 'During landing, the fuselage weight transfers through the landing gear (shock struts, oleos) to the ground. Forces at contact must equilibrate weight + inertial forces. Critical for structural design.',
                        example: 'Multi-point landing gear distributes vertical load; side forces arise from crosswind and braking.'
                    }
                };

                const info = contexts[ctx];
                html += `<h4>${info.title}</h4>`;
                html += `<p>${info.desc}</p>`;
                html += `<p><strong>Key Principle:</strong> ${info.example}</p>`;

                const result = app.calculateResultant();
                const sumM = app.calculateMoments();

                html += `<div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border);">`;
                html += `<strong>Current System State:</strong><br/>`;
                html += `<span class="value-display">Resultant: ${Math.sqrt(result.sumFx * result.sumFx + result.sumFy * result.sumFy).toFixed(2)} N</span>`;
                html += `<span class="value-display">Moment: ${sumM.toFixed(2)} N¬∑m</span>`;
                if (result.fxBalanced && result.fyBalanced && Math.abs(sumM) < 0.1) {
                    html += `<p style="color: var(--success); margin-top: 8px; font-weight: 600;">‚úì Equilibrium achieved!</p>`;
                } else {
                    html += `<p style="color: var(--warning); margin-top: 8px; font-weight: 600;">‚ö†Ô∏è Add more forces to achieve equilibrium</p>`;
                }
                html += `</div>`;

                document.getElementById('engineeringApp').innerHTML = html;
            }
        };

        window.onload = app.init;
    </script>
    <script src="../assets/site.js"></script>
</body>

</html>